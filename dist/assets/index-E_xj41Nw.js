var We=Object.defineProperty;var $e=(h,e,s)=>e in h?We(h,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[e]=s;var S=(h,e,s)=>($e(h,typeof e!="symbol"?e+"":e,s),s),qe=(h,e,s)=>{if(!e.has(h))throw TypeError("Cannot "+s)};var t=(h,e,s)=>(qe(h,e,"read from private field"),s?s.call(h):e.get(h)),r=(h,e,s)=>{if(e.has(h))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(h):e.set(h,s)},o=(h,e,s,i)=>(qe(h,e,"write to private field"),i?i.call(h,s):e.set(h,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}})();let Nt;var y,b,T,Ft,x,_,fe,v,vt,Ot,bt,Y,wt,kt,St,M,Q,Tt,ze;class Ue{constructor(e){S(this,"zoomYLevel",.2222);S(this,"zoomXLevel",0);r(this,y,void 0);r(this,b,void 0);r(this,T,void 0);r(this,Ft,void 0);r(this,x,void 0);r(this,_,void 0);r(this,fe,void 0);S(this,"minQty");S(this,"initialPrice");r(this,v,void 0);r(this,vt,void 0);r(this,Ot,!1);r(this,bt,void 0);r(this,Y,!0);r(this,wt,void 0);r(this,kt,!0);r(this,St,!0);r(this,M,!1);r(this,Q,!1);r(this,Tt,!1);r(this,ze,!1);o(this,y,new Qe(this,e[0].ctx,e[0].canvas,e[0].width,e[0].height)),o(this,T,new Ke(this,e[1].ctx,e[1].canvas,e[1].width,e[1].height)),o(this,x,new Re(this,e[2].ctx,e[2].canvas,e[2].width,e[2].height)),o(this,_,new Ge(this,e[3].ctx,e[3].canvas,e[3].width,e[3].height)),o(this,b,new Je(this,e[0].overlayCtx,e[0].overlayCanvas,e[0].width,e[0].height)),o(this,Ft,new je(this,e[1].overlayCtx,e[1].overlayCanvas,e[1].width,e[1].height)),t(this,b).canvas.addEventListener("mousedown",i=>{o(this,Ot,!0),o(this,bt,{x:i.clientX,y:i.clientY})}),t(this,b).canvas.addEventListener("mousemove",i=>{if(t(this,Ot)){o(this,Y,!1);let n={x:i.clientX,y:i.clientY},a=n.x-t(this,bt).x,l=n.y-t(this,bt).y;!t(this,M)&&t(this,Q)&&(o(this,M,!0),requestAnimationFrame(()=>{t(this,y).panXY(a,l),t(this,T).panY(l),t(this,x).panX(a),t(this,_).panX(a),t(this,y).updateData(t(this,v),[]),t(this,T).updateData(t(this,v),t(this,vt)),t(this,x).updateData(t(this,v)),t(this,_).updateData(t(this,v),[]),o(this,M,!1)})),o(this,bt,n),this.updateScaleBtn()}}),["mouseup","mouseleave"].forEach(i=>t(this,b).canvas.addEventListener(i,()=>o(this,Ot,!1))),t(this,b).canvas.addEventListener("wheel",i=>{i.preventDefault(),o(this,Y,!1);const n=5e-4/(.01-.001);let a=this.zoomYLevel-(i.deltaY>0?-n:n),l=this.zoomXLevel+(i.deltaY>0?-n:n);this.zoomYLevel=Math.max(0,Math.min(a,1)),this.zoomXLevel=Math.max(0,Math.min(l,1)),!t(this,M)&&t(this,Q)&&(o(this,M,!0),requestAnimationFrame(()=>{t(this,y).zoomY(this.zoomYLevel),t(this,y).zoomX(this.zoomXLevel),t(this,T).zoomY(this.zoomYLevel),t(this,x).zoomX(this.zoomXLevel),t(this,_).zoomX(this.zoomXLevel),t(this,y).updateData(t(this,v),[]),t(this,T).updateData(t(this,v),t(this,vt)),t(this,x).updateData(t(this,v)),t(this,_).updateData(t(this,v),[]),o(this,M,!1)}),this.updateScaleBtn())}),t(this,T).canvas.addEventListener("wheel",i=>{i.preventDefault(),o(this,Y,!1);const n=5e-4/(.01-.001);let a=this.zoomYLevel-(i.deltaY>0?-n:n);this.zoomYLevel=Math.max(0,Math.min(a,1)),!t(this,M)&&t(this,Q)&&(o(this,M,!0),requestAnimationFrame(()=>{t(this,y).zoomY(this.zoomYLevel),t(this,T).zoomY(this.zoomYLevel),t(this,y).updateData(t(this,v),[]),t(this,T).updateData(t(this,v),t(this,vt)),o(this,M,!1)}),this.updateScaleBtn())}),t(this,x).canvas.addEventListener("wheel",i=>{i.preventDefault(),o(this,Y,!1);const n=5e-4/(.01-.001);let a=this.zoomXLevel+(i.deltaY>0?-n:n);this.zoomXLevel=Math.max(0,Math.min(a,1)),!t(this,M)&&t(this,Q)&&(o(this,M,!0),requestAnimationFrame(()=>{t(this,y).zoomX(this.zoomXLevel),t(this,x).zoomX(this.zoomXLevel),t(this,_).zoomX(this.zoomXLevel),t(this,y).updateData(t(this,v),[]),t(this,x).updateData(t(this,v)),t(this,_).updateData(t(this,v),[]),o(this,M,!1)})),this.updateScaleBtn()}),t(this,b).canvas.addEventListener("mousemove",i=>{const n=t(this,b).canvas.getBoundingClientRect(),a=i.clientX-n.left,l=i.clientY-n.top;t(this,b).updateCrosshair(a,l)}),t(this,b).canvas.addEventListener("mouseleave",()=>t(this,b).clearCrosshair()),document.querySelectorAll("#top-nav button").forEach(i=>{i.addEventListener("click",(function(n){const a=n.target;a.id==="tf1m"||a.id==="tf3m"||a.id==="tf5m"||a.id==="tf15m"||(a.id==="cvdToggleBtn"?(a.classList.toggle("disabled"),o(this,kt,!t(this,kt)),t(this,_).toggleIndicator("cvd",t(this,kt))):a.id==="oiToggleBtn"&&(a.classList.toggle("disabled"),o(this,St,!t(this,St)),t(this,_).toggleIndicator("oi",t(this,St))),!t(this,kt)&&!t(this,St)?(document.querySelector("#canvas4").style.display="none",document.querySelector("#canvas1").style.height="90%",document.querySelector("#canvas2").style.height="90%",document.querySelector("#canvas3").style.height="10%",document.querySelector("#canvas3").style.top="90%"):(document.querySelector("#canvas4").style.display="flex",document.querySelector("#canvas1").style.height="80%",document.querySelector("#canvas2").style.height="80%",document.querySelector("#canvas3").style.height="10%",document.querySelector("#canvas3").style.top="90%"))}).bind(this))}),document.querySelector("#crosshairBtn").addEventListener("click",i=>{document.querySelector("#crosshairBtn").classList.toggle("disabled"),t(this,b).crosshairSelected=!t(this,b).crosshairSelected}),o(this,wt,document.querySelector("#btn2")),t(this,wt).addEventListener("click",i=>{o(this,Y,!t(this,Y)),this.updateScaleBtn()});const s=document.querySelector("#ticksize-select");s.addEventListener("change",i=>{const n=t(this,fe)*s.value;console.log("new tick size:",n),t(this,y).bucketSize=n,t(this,b).bucketSize=n,t(this,y).maxQty=0,t(this,T).bucketSize=n,t(this,Ft).bucketSize=n})}async fetchHistKlines(e,s,i,n,a){o(this,Tt,!0);try{return await(await fetch(`https://fapi.binance.com/fapi/v1/klines?symbol=${e}&interval=${s}${i?"&startTime="+i:""}${n?"&endTime="+n:""}&limit=${a}`)).json()}catch(l){return console.log(l,e),NaN}}async getHistKlines(e,s,i){if(t(this,Tt)){console.log("already fetching historical klines...");return}o(this,Tt,!0),this.fetchHistKlines(Nt,"1m",e,s,i).then(n=>{t(this,y).resolveHistData("klines",n),t(this,x).resolveHistData("klines",n),o(this,Tt,!1)})}async fetchHistTrades(e,s,i,n){try{const a=`https://fapi.binance.com/fapi/v1/aggTrades?symbol=${e}${s?"&startTime="+s:""}${i?"&endTime="+i:""}${n?"&limit="+n:""}`;return(await(await fetch(a)).json()).map(d=>({x:d.T,y:parseFloat(d.p),q:parseFloat(d.q),m:d.m}))}catch(a){return console.log(a,url),NaN}}updateScaleBtn(){t(this,Y)?(t(this,y).resetZoomAndPan(),t(this,T).resetZoomAndPan(),t(this,x).resetZoomAndPan(),t(this,_).resetZoomAndPan(),t(this,wt).innerHTML='<svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 448 512"><path fill="#c8c8c8" d="M144 144v48H304V144c0-44.2-35.8-80-80-80s-80 35.8-80 80zM80 192V144C80 64.5 144.5 0 224 0s144 64.5 144 144v48h16c35.3 0 64 28.7 64 64V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V256c0-35.3 28.7-64 64-64H80z"/></svg>'):t(this,wt).innerHTML='<svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 576 512"><path fill="#c8c8c8" d="M352 144c0-44.2 35.8-80 80-80s80 35.8 80 80v48c0 17.7 14.3 32 32 32s32-14.3 32-32V144C576 64.5 511.5 0 432 0S288 64.5 288 144v48H64c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V256c0-35.3-28.7-64-64-64H352V144z"/></svg>'}updateData(e){o(this,v,e.kline),o(this,vt,e.depth),t(this,y).updateData(e.kline,e.tradesBuffer),t(this,T).updateData(e.kline,e.depth),t(this,x).updateData(e.kline),t(this,_).updateData(e.kline,e.tradesBuffer)}startNew(e,s,i,n){o(this,Q,!1),Nt=e,o(this,fe,s),this.minQty=i,this.initialPrice=n,this.zoomYLevel=.2222,this.zoomXLevel=0,o(this,Y,!0),this.updateScaleBtn(),t(this,y).resetData(),t(this,T).resetData(),t(this,x).resetData(),t(this,_).resetData(),t(this,Q)||setTimeout(()=>{o(this,Q,!0)},3e3)}drawScale(e,s){t(this,Ft).drawStart(e,s)}}y=new WeakMap,b=new WeakMap,T=new WeakMap,Ft=new WeakMap,x=new WeakMap,_=new WeakMap,fe=new WeakMap,v=new WeakMap,vt=new WeakMap,Ot=new WeakMap,bt=new WeakMap,Y=new WeakMap,wt=new WeakMap,kt=new WeakMap,St=new WeakMap,M=new WeakMap,Q=new WeakMap,Tt=new WeakMap,ze=new WeakMap;var xt,m,K,A,P,ct,Z,st,Se,q,_t,Yt,D,Zt,Wt,dt,$t,Ut,V,ut,Mt,Dt,Ct,Qt,it;class Qe{constructor(e,s,i,n,a){r(this,xt,void 0);r(this,m,void 0);r(this,K,void 0);r(this,A,void 0);r(this,P,[]);r(this,ct,[]);r(this,Z,void 0);r(this,st,[]);r(this,Se,void 0);r(this,q,void 0);r(this,_t,void 0);r(this,Yt,60);r(this,D,void 0);r(this,Zt,.997);r(this,Wt,1.003);r(this,dt,30);S(this,"bucketSize");r(this,$t,void 0);S(this,"maxQty");r(this,Ut,!0);r(this,V,0);r(this,ut,0);r(this,Mt,null);r(this,Dt,[]);r(this,Ct,!1);r(this,Qt,!1);r(this,it,!1);o(this,xt,e),o(this,m,s),this.canvas=i,o(this,K,n),o(this,A,a),o(this,D,Math.round(1*60*1e3/(30*60*1e3)*(t(this,K)-t(this,Yt))))}panXY(e,s){o(this,Ut,!1);const i=t(this,A)/(t(this,_t)-t(this,q)),n=s/i;o(this,ut,t(this,ut)+n),o(this,V,t(this,V)+e<0?0:t(this,V)+e)}zoomY(e){const l=.001+.009000000000000001*e,c=.001+(.01-.001)*e;o(this,Zt,Math.round((1-l)*1e4)/1e4),o(this,Wt,Math.round((1+c)*1e4)/1e4)}zoomX(e){o(this,dt,Math.round(30+-20*e)),o(this,D,Math.round(1*60*1e3/(t(this,dt)*60*1e3)*(t(this,K)-t(this,Yt))))}resetZoomAndPan(){o(this,Ut,!0),o(this,V,0),o(this,ut,0),o(this,Zt,.997),o(this,Wt,1.003),o(this,dt,30),o(this,D,Math.round(1*60*1e3/(t(this,dt)*60*1e3)*(t(this,K)-t(this,Yt))))}resetData(){o(this,P,[]),o(this,ct,[]),o(this,Z,null),o(this,st,[]),o(this,Se,null),o(this,q,null),o(this,_t,null),o(this,Ut,!0),o(this,V,0),o(this,ut,0),o(this,Mt,null),o(this,Ct,!1),o(this,Qt,!1),o(this,it,!1),o(this,$t,t(this,xt).minQty),this.maxQty=0}resolveHistData(e,s){e==="klines"&&(o(this,Ct,!0),s.forEach(i=>{const[n,a,l,c,d,,u]=i,g={startTime:n,openPrice:a,highPrice:l,lowPrice:c,closePrice:d,endTime:u};t(this,P).unshift(g),t(this,ct).unshift([])}))}async getHistTrades(e){if(t(this,it)){console.log("already fetching historical trades...");return}o(this,it,!0);for(let s=0;s<t(this,P).length;s++){const i=t(this,P)[s];let n=i.startTime;const a=i.endTime;let l=[],c=0;console.log("getting historical trades:",s+1,"of",t(this,P).length,"klines...");do{if(e!=Nt){console.log("stopped fetching historical trades for",e),o(this,it,!1);return}try{const d=await t(this,xt).fetchHistTrades(Nt,n,a,1e3);l=l.concat(d),c=d[d.length-1].x,n=c+1,console.log("fetched",d.length,"trades"),await new Promise(u=>setTimeout(u,500))}catch(d){console.log(d,n,a);break}}while(c<a);t(this,ct)[s]=l}o(this,it,!1),o(this,Qt,!0)}updateData(e,s){const{E:i,k:{t:n,o:a,h:l,l:c,c:d,T:u}}=e;(i>t(this,Mt)||t(this,Mt)===null)&&(t(this,Z)&&t(this,Z).endTime!==u&&(t(this,P).push(t(this,Z)),t(this,ct).push(t(this,st)),o(this,st,[])),o(this,Mt,u)),o(this,Z,{startTime:n,openPrice:a,highPrice:l,lowPrice:c,closePrice:d,endTime:u});for(let g=0;g<s.length;g++){const B=s[g];if(B.x>=n&&B.x<u)t(this,st).push(B);else if(B.x>=u){t(this,Dt).push(...s.slice(g));break}}if(t(this,Dt).length>0&&o(this,Dt,t(this,Dt).filter(g=>g.x>=n&&g.x<u?(t(this,st).push(g),!1):!0)),o(this,q,Math.min((Number(l)+Number(c))/2*t(this,Zt),c)+t(this,ut)),o(this,_t,Math.max((Number(l)+Number(c))/2*t(this,Wt),l)+t(this,ut)),this.drawStart(),t(this,P).length<60&&!t(this,Ct)){console.log("getting historical klines...");const g=null,B=60-t(this,P).length,k=t(this,Z).startTime-1;t(this,xt).getHistKlines(g,k,B)}t(this,Ct)&&!t(this,it)&&!t(this,Qt)&&this.getHistTrades(Nt)}drawStart(){t(this,m).clearRect(0,0,t(this,K),t(this,A));const e=Math.round(t(this,K)-t(this,D));if(t(this,P).length>0){const s=t(this,dt)*60*1e3,i=t(this,Z).startTime-s,n=0-t(this,V),a=t(this,K)-t(this,V);t(this,P).forEach((l,c)=>{const d=t(this,ct)[c],u=Math.round((l.startTime-i)/s*e);u>=n&&u<=a&&this.drawDataPoint(d,l,u+t(this,V))})}this.drawDataPoint(t(this,st),t(this,Z),e+t(this,V))}drawDataPoint(e,s,i){const n=t(this,A)/(t(this,_t)-t(this,q));if(e){const g=[].concat(...e).reduce((k,tt)=>{const qt=Math.round(tt.y/this.bucketSize)*this.bucketSize,et=`${qt}-${tt.m}`;return k[et]||(k[et]={...tt,y:qt,q:0}),k[et].q+=tt.q,k},{}),B=Math.max(...Object.values(g).map(k=>k.q));this.maxQty=B>this.maxQty?B:this.maxQty,Object.values(g).forEach(k=>{const tt=Math.round(t(this,A)-(k.y-t(this,q))*n),qt=this.scaleQuantity(k.q);this.drawTradesAt(i,tt,k.m,qt)})}const a=Math.round(t(this,A)-(s.openPrice-t(this,q))*n),l=Math.round(t(this,A)-(s.highPrice-t(this,q))*n),c=Math.round(t(this,A)-(s.lowPrice-t(this,q))*n),d=Math.round(t(this,A)-(s.closePrice-t(this,q))*n);this.drawKlineAt(i,l-2),this.drawKlineAt(i,c+2),t(this,m).beginPath(),t(this,m).moveTo(i+t(this,D)/2,a),t(this,m).lineTo(i+t(this,D)/2,d),t(this,m).shadowColor=d<a?"rgba(155, 230, 209, 0.5)":"rgba(230, 161, 160, 0.5)",t(this,m).shadowBlur=5,t(this,m).strokeStyle=d<a?"rgba(155, 230, 209, 0.5)":"rgba(230, 161, 160, 0.5)",t(this,m).stroke(),t(this,m).shadowColor="transparent",t(this,m).shadowBlur=0}drawKlineAt(e,s){t(this,m).beginPath(),t(this,m).moveTo(e+5,s),t(this,m).lineTo(e+t(this,D)-5,s),t(this,m).strokeStyle="rgba(200, 200, 200, 0.5)",t(this,m).stroke()}drawTradesAt(e,s,i,n){t(this,m).beginPath(),i?(t(this,m).moveTo(e-4+t(this,D)/2,s),t(this,m).lineTo(e-4+t(this,D)/2-n,s),t(this,m).strokeStyle="rgba(192, 80, 77, 1)"):(t(this,m).moveTo(e+4+t(this,D)/2,s),t(this,m).lineTo(e+4+t(this,D)/2+n,s),t(this,m).strokeStyle="rgba(81, 205, 160, 1)"),t(this,m).stroke()}scaleQuantity(e){const i=t(this,D)/2-4;return 0+(e-t(this,$t))*(i-0)/(this.maxQty-t(this,$t))}}xt=new WeakMap,m=new WeakMap,K=new WeakMap,A=new WeakMap,P=new WeakMap,ct=new WeakMap,Z=new WeakMap,st=new WeakMap,Se=new WeakMap,q=new WeakMap,_t=new WeakMap,Yt=new WeakMap,D=new WeakMap,Zt=new WeakMap,Wt=new WeakMap,dt=new WeakMap,$t=new WeakMap,Ut=new WeakMap,V=new WeakMap,ut=new WeakMap,Mt=new WeakMap,Dt=new WeakMap,Ct=new WeakMap,Qt=new WeakMap,it=new WeakMap;var Kt,f,Lt,W,Rt,ot,N,mt,Gt,Jt,jt,Pt,pe,te;class Ke{constructor(e,s,i,n,a){r(this,Kt,void 0);r(this,f,void 0);r(this,Lt,void 0);r(this,W,void 0);r(this,Rt,void 0);r(this,ot,void 0);r(this,N,void 0);r(this,mt,void 0);r(this,Gt,.997);r(this,Jt,1.003);S(this,"bucketSize");r(this,jt,!0);r(this,Pt,0);r(this,pe,void 0);r(this,te,void 0);o(this,Kt,e),o(this,f,s),this.canvas=i,o(this,Lt,n),o(this,W,a)}panY(e){o(this,jt,!1);const s=t(this,W)/(t(this,mt)-t(this,N)),i=e/s;o(this,Pt,t(this,Pt)+i)}zoomY(e){const l=.001+.009000000000000001*e,c=.001+(.01-.001)*e;o(this,Gt,Math.round((1-l)*1e4)/1e4),o(this,Jt,Math.round((1+c)*1e4)/1e4)}resetZoomAndPan(){o(this,jt,!0),o(this,Gt,.997),o(this,Jt,1.003),o(this,Pt,0)}resetData(){o(this,Rt,null),o(this,ot,null),o(this,N,null),o(this,mt,null),o(this,jt,!0),o(this,pe,Math.round(1e6/t(this,Kt).initialPrice)),o(this,te,t(this,pe))}updateData(e,s){const{k:{o:i,h:n,l:a,c:l}}=e;o(this,Rt,{openPrice:i,highPrice:n,lowPrice:a,closePrice:l});const{asks:c,bids:d}=s;o(this,ot,{asks:c,bids:d}),o(this,N,Math.min((Number(n)+Number(a))/2*t(this,Gt),a)+t(this,Pt)),o(this,mt,Math.max((Number(n)+Number(a))/2*t(this,Jt),n)+t(this,Pt)),this.drawStart(),t(this,Kt).drawScale(t(this,N),t(this,mt))}drawStart(){t(this,f).clearRect(0,0,t(this,Lt),t(this,W));const e=t(this,W)/(t(this,mt)-t(this,N)),{closePrice:s,openPrice:i}=t(this,Rt),n=Math.round(t(this,W)-(s-t(this,N))*e),a=Math.round(t(this,W)-(i-t(this,N))*e);if(this.maxQuantity=t(this,te),t(this,ot).asks&&t(this,ot).bids){const B=et=>et.reduce((lt,Vt)=>{const De=Math.round(Vt[0]/this.bucketSize)*this.bucketSize;return lt[De]||(lt[De]=0),lt[De]+=parseFloat(Vt[1]),lt},{}),k=B(t(this,ot).asks),tt=B(t(this,ot).bids),qt=[...Object.values(k),...Object.values(tt)];this.maxQuantity=Math.max(t(this,te),...qt),Object.entries(k).forEach(([et,lt])=>{const Vt=Math.round(t(this,W)-(et-t(this,N))*e);this.drawLineAt(Vt,"#C0504E",lt)}),Object.entries(tt).forEach(([et,lt])=>{const Vt=Math.round(t(this,W)-(et-t(this,N))*e);this.drawLineAt(Vt,"#51CDA0",lt)})}t(this,f).font="10px monospace",t(this,f).fillStyle="#c8c8c8";let l=Math.round(this.maxQuantity),c=t(this,f).measureText(l).width;t(this,f).fillText(l,t(this,Lt)-5-c,20);const d={"#C0504E":"rgba(192, 80, 78, 0.5)","#51CDA0":"rgba(81, 205, 160, 0.5)","#c8c8c8":"rgba(200, 200, 200, 0.5)"},u=n>a?"#C0504E":n<a?"#51CDA0":"#c8c8c8",g=d[u];this.drawTextWithBackground(n,Number(s),"#212121",u,g)}drawLineAt(e,s,i){const n=i/this.maxQuantity*(t(this,Lt)-60);t(this,f).beginPath(),t(this,f).moveTo(60,e),t(this,f).lineTo(n+60,e),t(this,f).strokeStyle=s,t(this,f).lineWidth=1,t(this,f).stroke()}drawTextWithBackground(e,s,i,n,a){t(this,f).font="11px monospace";const l=t(this,f).measureText(s).width;t(this,f).shadowColor=a,t(this,f).shadowBlur=5,t(this,f).fillStyle=n,t(this,f).fillRect(3,e-10,l+4,12),t(this,f).shadowColor="transparent",t(this,f).shadowBlur=0,t(this,f).fillStyle=i,t(this,f).fillText(s,5,e)}}Kt=new WeakMap,f=new WeakMap,Lt=new WeakMap,W=new WeakMap,Rt=new WeakMap,ot=new WeakMap,N=new WeakMap,mt=new WeakMap,Gt=new WeakMap,Jt=new WeakMap,jt=new WeakMap,Pt=new WeakMap,pe=new WeakMap,te=new WeakMap;var Te,p,R,z,nt,at,ee,se,ie,X,ht,H,ge;class Re{constructor(e,s,i,n,a){r(this,Te,void 0);r(this,p,void 0);r(this,R,void 0);r(this,z,void 0);r(this,nt,[]);r(this,at,void 0);r(this,ee,void 0);r(this,se,void 0);r(this,ie,60);r(this,X,void 0);r(this,ht,30);r(this,H,0);r(this,ge,!1);o(this,Te,e),o(this,p,s),this.canvas=i,o(this,R,n),o(this,z,a),o(this,X,Math.round(1*60*1e3/(t(this,ht)*60*1e3)*(t(this,R)-t(this,ie))))}panX(e){o(this,H,t(this,H)+e<0?0:t(this,H)+e)}zoomX(e){o(this,ht,30+-20*e),o(this,X,Math.round(1*60*1e3/(t(this,ht)*60*1e3)*(t(this,R)-t(this,ie))))}resetZoomAndPan(){o(this,H,0),o(this,ht,30),o(this,X,Math.round(1*60*1e3/(t(this,ht)*60*1e3)*(t(this,R)-t(this,ie))))}resetData(){o(this,nt,[]),o(this,at,null),o(this,ee,null),o(this,se,null),o(this,H,0),o(this,ge,!1)}resolveHistData(e,s){e==="klines"&&(o(this,ge,!0),s.forEach(i=>{const[n,,,,,a,l,,,c,,,]=i,d={startTime:n,endTime:l,totalVolume:a,buyVolume:c,sellVolume:a-c};t(this,nt).unshift(d)}))}updateData(e){const{k:{t:s,T:i,v:n,V:a}}=e,l=n-a;o(this,se,Math.round(t(this,nt).reduce((c,d)=>Math.max(c,d.buyVolume,d.sellVolume),Math.max(a,l)))),t(this,ee)!==s&&(t(this,at)&&t(this,nt).push(t(this,at)),o(this,ee,s)),o(this,at,{startTime:s,endTime:i,buyVolume:a,sellVolume:l}),this.drawStart()}drawStart(){t(this,p).clearRect(0,0,t(this,R),t(this,z));const e=Math.round(t(this,R)-t(this,X));if(t(this,nt).length>0){const s=t(this,ht)*60*1e3,i=t(this,at).startTime-s,n=0-t(this,H),a=t(this,R)-t(this,H);t(this,nt).forEach((l,c)=>{const d=Math.round((l.startTime-i)/s*e);d>=n&&d<=a&&this.drawDataPoint(l,d+t(this,H))})}this.drawDataPoint(t(this,at),e+t(this,H))}drawDataPoint(e,s){const i=(t(this,z)-20)/t(this,se),n=Math.max(0,Math.min(t(this,z)-20,Math.round(t(this,z)-20-e.buyVolume*i))),a=Math.max(0,Math.min(t(this,z)-20,Math.round(t(this,z)-20-e.sellVolume*i)));t(this,p).beginPath(),t(this,p).moveTo(s,0),t(this,p).lineTo(s,t(this,z)-20),t(this,p).strokeStyle="rgba(200, 200, 200, 0.4)",t(this,p).lineWidth=1,t(this,p).stroke(),this.drawTimeLabel(s,e.startTime),this.drawKlineAt(s+t(this,X)/2+t(this,X)/8,n,"#51CDA0","rgba(81, 205, 160, 0.4)"),this.drawKlineAt(s+t(this,X)/2-t(this,X)/8,a,"#C0504E","rgba(192, 80, 77, 0.4)")}drawKlineAt(e,s,i,n){t(this,p).beginPath(),t(this,p).moveTo(e,t(this,z)-20),t(this,p).lineTo(e,s),t(this,p).strokeStyle=i,t(this,p).lineWidth=t(this,X)/6,t(this,p).shadowColor=n,t(this,p).shadowBlur=3,t(this,p).stroke(),t(this,p).shadowColor="transparent",t(this,p).shadowBlur=0}drawTimeLabel(e,s){const i=new Date(s),n=i.getHours().toString().padStart(2,"0")+":"+i.getMinutes().toString().padStart(2,"0");t(this,p).font="11px monospace",t(this,p).fillStyle="#c8c8c8",t(this,p).fillText(n,e,t(this,z)-5)}}Te=new WeakMap,p=new WeakMap,R=new WeakMap,z=new WeakMap,nt=new WeakMap,at=new WeakMap,ee=new WeakMap,se=new WeakMap,ie=new WeakMap,X=new WeakMap,ht=new WeakMap,H=new WeakMap,ge=new WeakMap;var xe,C,G,F,L,$,Ee,U,oe,ne,zt,ae,J,he,O,j,E,re,le,Et,ye,ft;class Ge{constructor(e,s,i,n,a){r(this,xe,void 0);r(this,C,void 0);r(this,G,void 0);r(this,F,void 0);r(this,L,[]);r(this,$,void 0);r(this,Ee,void 0);r(this,U,[]);r(this,oe,void 0);r(this,ne,void 0);r(this,zt,void 0);r(this,ae,void 0);r(this,J,void 0);r(this,he,60);r(this,O,void 0);r(this,j,30);r(this,E,0);r(this,re,0);r(this,le,!0);r(this,Et,!0);r(this,ye,void 0);r(this,ft,void 0);o(this,xe,e),o(this,C,s),this.canvas=i,o(this,G,n),o(this,F,a),o(this,O,Math.round(1*60*1e3/(t(this,j)*60*1e3)*(t(this,G)-t(this,he))))}panX(e){o(this,E,t(this,E)+e<0?0:t(this,E)+e)}zoomX(e){o(this,j,30+-20*e),o(this,O,Math.round(1*60*1e3/(t(this,j)*60*1e3)*(t(this,G)-t(this,he))))}resetZoomAndPan(){o(this,E,0),o(this,j,30),o(this,O,Math.round(1*60*1e3/(t(this,j)*60*1e3)*(t(this,G)-t(this,he))))}resetData(){o(this,L,[]),o(this,U,[]),o(this,$,null),o(this,oe,null),o(this,ne,null),o(this,zt,null),o(this,ae,null),o(this,J,null),o(this,re,0),o(this,E,0)}toggleIndicator(e,s){e==="oi"?o(this,le,s):e==="cvd"&&o(this,Et,s)}async updateData(e,s){const{k:{t:i,T:n}}=e;if(o(this,re,t(this,re)+s.reduce((a,l)=>l.m?a-l.q:a+l.q,0)),t(this,oe)!==i&&(t(this,$)&&(this.fetchOI(Nt).then(a=>{t(this,U).push(a)}),t(this,L).push(t(this,$)),t(this,L).length>60&&(t(this,L).shift(),t(this,U).shift())),o(this,oe,i)),o(this,$,{startTime:i,endTime:n,cumVolumeDelta:t(this,re)}),t(this,le)||t(this,Et)){o(this,ne,t(this,U).length>0?Math.max(...t(this,U).map(Number))*1.001:0),o(this,zt,t(this,U).length>0?Math.min(...t(this,U).map(Number))*.999:0);const a=t(this,L).map(l=>l.cumVolumeDelta);o(this,ae,(Math.max(...a,t(this,$).cumVolumeDelta)||0)*1.001),o(this,J,(Math.min(...a,t(this,$).cumVolumeDelta)||0)*.999),o(this,ye,t(this,F)/(t(this,ne)-t(this,zt))),o(this,ft,t(this,F)/(t(this,ae)-t(this,J))),this.drawStart()}}drawStart(){if(t(this,C).clearRect(0,0,t(this,G),t(this,F)),t(this,L).length>0){const e=t(this,$).startTime-t(this,j)*60*1e3+t(this,E);t(this,L).forEach((s,i)=>{const n=Math.round((s.startTime-e)/(t(this,j)*60*1e3)*(t(this,G)-t(this,O)));if(t(this,le)){const a=t(this,F)-(t(this,U)[i]-t(this,zt))*t(this,ye);this.drawOIPoint(n+t(this,E),a)}if(t(this,Et)){const a=t(this,F)-(s.cumVolumeDelta-t(this,J))*t(this,ft);if(i>0){const l=t(this,F)-(t(this,L)[i-1].cumVolumeDelta-t(this,J))*t(this,ft);this.drawCVDLine(n+t(this,E),l,n+t(this,O)+t(this,E),a)}}})}if(t(this,Et)){const e=t(this,F)-(t(this,$).cumVolumeDelta-t(this,J))*t(this,ft),s=Math.round(t(this,G)-t(this,O))+t(this,E);if(t(this,L).length>0){const i=t(this,F)-(t(this,L)[t(this,L).length-1].cumVolumeDelta-t(this,J))*t(this,ft);this.drawCVDLine(s,i,s+t(this,O),e)}else this.drawCVDLine(s,0,s+t(this,O),e)}}drawCVDLine(e,s,i,n){t(this,C).beginPath(),t(this,C).moveTo(e,s),t(this,C).lineTo(i,n),t(this,C).lineWidth=2,t(this,C).strokeStyle="rgba(238, 216, 139, 0.3)",t(this,C).stroke()}drawOIPoint(e,s){t(this,C).beginPath(),t(this,C).arc(e+t(this,O),s,2,0,2*Math.PI),t(this,C).fillStyle="#c8c8c8",t(this,C).fill()}async fetchOI(e){return(await(await fetch(`https://fapi.binance.com/fapi/v1/openInterest?symbol=${e}`)).json()).openInterest}}xe=new WeakMap,C=new WeakMap,G=new WeakMap,F=new WeakMap,L=new WeakMap,$=new WeakMap,Ee=new WeakMap,U=new WeakMap,oe=new WeakMap,ne=new WeakMap,zt=new WeakMap,ae=new WeakMap,J=new WeakMap,he=new WeakMap,O=new WeakMap,j=new WeakMap,E=new WeakMap,re=new WeakMap,le=new WeakMap,Et=new WeakMap,ye=new WeakMap,ft=new WeakMap;var _e,w,It,Bt,Ie,Be;class Je{constructor(e,s,i,n,a){r(this,_e,void 0);r(this,w,void 0);r(this,It,void 0);r(this,Bt,void 0);r(this,Ie,void 0);r(this,Be,void 0);S(this,"crosshairSelected",!1);o(this,_e,e),o(this,w,s),this.canvas=i,o(this,It,n),o(this,Bt,a)}updateCrosshair(e,s){this.crosshairSelected&&(t(this,w).clearRect(0,0,t(this,It),t(this,Bt)),this.drawCrosshair(e,s))}drawCrosshair(e,s){t(this,w).beginPath(),t(this,w).moveTo(e,0),t(this,w).lineTo(e,t(this,Bt)),t(this,w).strokeStyle="rgba(200, 200, 200, 0.5)",t(this,w).stroke(),t(this,w).beginPath(),t(this,w).moveTo(0,s),t(this,w).lineTo(t(this,It),s),t(this,w).strokeStyle="rgba(200, 200, 200, 0.5)",t(this,w).stroke()}clearCrosshair(){t(this,w).clearRect(0,0,t(this,It),t(this,Bt))}}_e=new WeakMap,w=new WeakMap,It=new WeakMap,Bt=new WeakMap,Ie=new WeakMap,Be=new WeakMap;var Me,pt,ve,At,be,we;class je{constructor(e,s,i,n,a){r(this,Me,void 0);r(this,pt,void 0);r(this,ve,void 0);r(this,At,void 0);S(this,"bucketSize");r(this,be,void 0);r(this,we,void 0);o(this,Me,e),o(this,pt,s),this.canvas=i,o(this,ve,n),o(this,At,a)}drawStart(e,s){if(e===t(this,be)&&s===t(this,we))return;t(this,pt).clearRect(0,0,t(this,ve),t(this,At)),o(this,be,e),o(this,we,s);const i=t(this,At)/(s-e),n=20,a=(s-e)/n;for(let l=0;l<=n;l++){let c=e+l*a;c=Number((Math.round(c/this.bucketSize)*this.bucketSize).toFixed(4));const d=Math.round(t(this,At)-(c-e)*i);this.drawTextAt(d,Number(c.toFixed(4)),"#c8c8c8")}}drawTextAt(e,s,i){t(this,pt).font="11px monospace",t(this,pt).fillStyle=i,t(this,pt).fillText(s,5,e)}}Me=new WeakMap,pt=new WeakMap,ve=new WeakMap,At=new WeakMap,be=new WeakMap,we=new WeakMap;async function Fe(){let e=Date.now()-25*60*60*1e3,s=e+60*60*1e3,i={};const[n,a]=await Promise.all([ss(),is()]),l=Object.keys(n).filter(u=>!["BTCSTUSDT","CVCUSDT","DOGEUSDC","COCOSUSDT","BNBBTC","ETHBTC","RAYUSDT","HNTUSDT","SCUSDT","WIFUSDT","BTSUSDT","TOMOUSDT","FTTUSDT","SRMUSDT"].includes(u)&&!u.includes("_")),c=l.map(u=>ts(u,e,s)),d=await Promise.all(c);return l.forEach((u,g)=>{a.hasOwnProperty(u)&&(i[u]={...n[u],...a[u],...d[g]})}),i}async function ts(h,e,s){let i;try{i=await es(h);const a=await(await fetch(`https://fapi.binance.com/futures/data/openInterestHist?symbol=${h}&period=30m&limit=1&startTime=${e}&endTime=${s}`)).json(),l=Math.round(a[0].sumOpenInterest),c=Math.round((i-l)/l*1e4)/100;return{open_interest:i,OI_24hrChange:c}}catch{return{open_interest:i,OI_24hrChange:NaN}}}async function es(h){try{const s=await(await fetch(`https://fapi.binance.com/fapi/v1/openInterest?symbol=${h}`)).json();return Number(s.openInterest)}catch(e){return console.log(e,h),NaN}}async function ss(){let h={};const s=await(await fetch("https://fapi.binance.com/fapi/v1/premiumIndex")).json();for(let i of s){let n=i.symbol,a=parseFloat(i.lastFundingRate)*100,l=parseFloat(i.markPrice);h[n]={funding_rate:parseFloat(a.toFixed(3)),mark_price:Math.round(l*1e4)/1e4}}return h}async function is(){let h={};const s=await(await fetch("https://fapi.binance.com/fapi/v1/ticker/24hr")).json();for(let i of s){let n=i.symbol,a=i.quoteVolume,l=i.priceChangePercent;h[n]={change:Number(l),volume:Math.round(a)}}return h}var gt,yt,ce,I,de;class os{constructor(){r(this,gt,void 0);r(this,yt,[]);r(this,ce,[]);r(this,I,void 0);r(this,de,!0);S(this,"last_update_id");S(this,"order_book");console.log("Initializing WebSocketService")}createWebSocket(e,s){t(this,gt)&&t(this,gt).readyState===1&&(console.log("Closing existing websocket connection for symbol:",t(this,I).toUpperCase()),this.order_book.shouldRefresh=!1,t(this,gt).close(),o(this,de,!0),this.order_book=null,o(this,yt,[]),o(this,ce,[])),console.log("Creating websocket connection for symbol:",e),o(this,I,e.toLowerCase()),Pe(t(this,I)).then(i=>{o(this,gt,new WebSocket(`wss://fstream.binance.com/stream?streams=${t(this,I)}@aggTrade/${t(this,I)}@depth@100ms/${t(this,I)}@kline_1m`)),this.setupEventListeners(t(this,gt),s),this.last_update_id=i.lastUpdateId,this.order_book=new ns(t(this,I),i.bids,i.asks)}).catch(i=>{console.error("Error initializing the order book:",i)})}setupEventListeners(e,s){e.addEventListener("open",()=>{this.order_book.refresh_order_book(t(this,I)),console.log("New WebSocket connection opened")}),e.addEventListener("close",()=>{console.log("Previous WebSocket connection was closed")});let i=!1;e.addEventListener("message",async n=>{let a=JSON.parse(n.data);if(a.stream.endsWith("@aggTrade")){let l=a.data;t(this,yt).push({x:l.T,y:parseFloat(l.p),q:parseFloat(l.q),m:l.m})}else if(a.stream.endsWith("@depth@100ms")){if(i){console.log("isHandlingDepth:",i);return}i=!0,await this.handleDepth(a.data),i=!1,s({kline:t(this,ce),depth:this.order_book.order_book,tradesBuffer:t(this,yt)}),o(this,yt,[])}else a.stream.endsWith("@kline_1m")&&o(this,ce,a.data)})}async handleDepth(e){let s=e.u,i=e.U,n=e.pu;if(s<this.last_update_id){console.log("finalUpdateId < last_update_id",s,this.last_update_id);return}if(t(this,de))if(i<=this.last_update_id&&this.last_update_id<=s)console.log("First processed event succeeded"),o(this,de,!1);else{await this.reinitializeOrderBook(t(this,I));return}else if(n!=this.last_update_id){await this.reinitializeOrderBook(t(this,I));return}await this.order_book.update_order_book(e.b,e.a),this.last_update_id=s}async reinitializeOrderBook(e){console.log("Out of sync, reinitializing order book...");const s=await Pe(e);this.last_update_id=s.lastUpdateId,this.order_book.order_book=this.order_book.initialize_order_book(s.bids,s.asks),o(this,yt,[])}}gt=new WeakMap,yt=new WeakMap,ce=new WeakMap,I=new WeakMap,de=new WeakMap;class ns{constructor(e,s,i){S(this,"currentSymbol");S(this,"order_book");S(this,"shouldRefresh",!0);console.log("initializing new OrderBook class"),this.currentSymbol=e,this.order_book=this.initialize_order_book(s,i)}initialize_order_book(e,s){let i=e.map(a=>a.map(Number)),n=s.map(a=>a.map(Number));return{bids:i,asks:n}}async refresh_order_book(e){let s=new AbortController,i=setInterval(async()=>{if(!this.shouldRefresh||e!==this.currentSymbol)clearInterval(i),s.abort();else{s=new AbortController;try{let n=await Pe(e,{signal:s.signal});this.order_book=this.initialize_order_book(n.bids,n.asks)}catch(n){n.name==="AbortError"?console.log("Fetch operation aborted"):console.error("Error fetching order book:",n)}}},6e3)}async update_order_book(e,s){let i=e.map(a=>a.map(Number)),n=s.map(a=>a.map(Number));[this.order_book.bids,this.order_book.asks]=await this.prepare_order_book(this.order_book.bids,this.order_book.asks,i,n)}async prepare_order_book(e,s,i,n){try{const a=new Map([...e,...i].filter(u=>u[0]>=e[e.length-1][0])),l=new Map([...s,...n].filter(u=>u[0]<=s[s.length-1][0]));let c=Array.from(a.entries()).filter(u=>u[1]!==0).sort((u,g)=>g[0]-u[0]),d=Array.from(l.entries()).filter(u=>u[1]!==0).sort((u,g)=>u[0]-g[0]);return c[0][0]>=d[0][0]&&(c=c.filter(u=>u[0]<i[i.length-1][0]),d=d.filter(u=>u[0]>n[0][0]),console.log("Error: bids[0] >= asks[0], rehandled to: ",c[0][0],d[0][0])),[c,d]}catch(a){return console.error("Error preparing order book:",a),[i,n]}}}async function Pe(h){return await(await fetch(`https://fapi.binance.com/fapi/v1/depth?symbol=${h}&limit=500`)).json()}const Ce=["btn1","btn2","btn3","btn4"],as=["tickers-menu","menu2","menu3","settings-menu"],hs=[Ye,Ve,Ve,cs];for(let h=0;h<Ce.length;h++){const e=document.getElementById(Ce[h]);e.addEventListener("click",hs[h]),e.addEventListener("click",function(){me(Ce[h],as[h])})}const Xt=document.getElementById("tickers-menu"),Ht=document.getElementById("settings-menu");let Ae=document.getElementById("ticker-search"),ke;Ae.addEventListener("keyup",function(){ke=this.value.toLowerCase();let h=document.querySelectorAll("#ticker-table tbody tr");for(let e of h)e.cells[0].textContent.toLowerCase().includes(ke)?e.style.display="":e.style.display="none"});function rs(h,e){fs(h,e),console.log("canvas was started with symbol: "+h),Ae.value="",ke="";let s=document.querySelectorAll("#ticker-table tbody tr");for(let i of s)i.style.display="";Ye()}function ls(){const h=new Date,e=h.getHours().toString().padStart(2,"0"),s=h.getMinutes().toString().padStart(2,"0"),i=h.getSeconds().toString().padStart(2,"0");return e+":"+s+":"+i}function Oe(){const h=document.getElementById("tickers-update-info");h.textContent="Last updated at "+ls()}const rt=document.getElementById("tickers-update-btn");rt.addEventListener("click",function(){rt.className="loading-animation",rt.disabled=!0,Fe().then(h=>{rt.className="",Ze(h),Oe(),rt.disabled=!1})});window.onload=function(){rt.className="loading-animation",rt.disabled=!0,Fe().then(h=>{rt.className="",Ze(h),Oe(),rt.disabled=!1})};function Ve(){console.log("show menu")}function Ye(){Ae.value="",ke="";let h=document.querySelectorAll("#ticker-table tbody tr");for(let e of h)e.style.display="";Xt.style.display=Xt.style.display==="none"?"block":"none",me("btn1","tickers-menu"),Xt.style.display==="block"?document.addEventListener("click",ue):document.removeEventListener("click",ue)}function cs(){Ht.style.display=Ht.style.display==="none"?"block":"none",me("btn4","settings-menu"),Ht.style.display==="block"?document.addEventListener("click",ue):document.removeEventListener("click",ue)}function ue(h){const e=document.querySelector("#btn1"),s=document.querySelector("#btn4");!Ht.contains(h.target)&&!s.contains(h.target)&&(Ht.style.display="none",me("btn4","settings-menu")),!Xt.contains(h.target)&&!e.contains(h.target)&&(Xt.style.display="none",me("btn1","tickers-menu")),Ht.style.display==="none"&&Xt.style.display==="none"&&document.removeEventListener("click",ue)}function me(h,e){const s=document.getElementById(e),i=document.getElementById(h);(h==="btn1"||h==="btn4")&&(s.style.display==="block"?i.classList.add("active"):i.classList.remove("active"))}function Ne(h){return h>=1e9?(h/1e9).toFixed(2)+"b":h>=1e6?(h/1e6).toFixed(2)+"m":h>=1e3?(h/1e3).toFixed(2)+"k":h}function Le(h,e,s){let i;return e==="mark_price"?h>10?i=Math.round(h*100)/100:i=Math.round(h*1e4)/1e4:e==="volume"?(i=Ne(h),i="$"+i):e==="open_interest"&&(i=Ne(h*s),i="$"+i),i}function Ze(h){let e=document.querySelector("#tickers-menu table tbody");e.innerHTML="";let s=Object.entries(h);s.sort(([,i],[,n])=>n.volume-i.volume);for(let i=0;i<s.length;i++){let[n,a]=s[i],l;i<e.rows.length?l=e.rows[i]:(l=e.insertRow(),l.insertCell(),l.insertCell(),l.insertCell(),l.insertCell(),l.insertCell(),l.insertCell(),l.insertCell()),l.classList.add("table-row"),l.cells[0].textContent=n,l.cells[1].textContent=Le(a.mark_price,"mark_price",a.mark_price),l.cells[2].textContent=(Math.round(a.change*100)/100).toFixed(2)+"%",l.cells[3].textContent=a.funding_rate+"%",l.cells[4].textContent=Le(a.open_interest,"open_interest",a.mark_price),l.cells[5].textContent=a.OI_24hrChange+"%",l.cells[6].textContent=Le(a.volume,"volume",a.mark_price);const c=Math.min(Math.abs(a.change/100),1),d=Math.max(Math.abs(a.funding_rate*50),.2);a.change<0?l.style.backgroundColor="rgba(192, 80, 78, "+c*1.5+")":l.style.backgroundColor="rgba(81, 205, 160, "+c+")",a.funding_rate>0?l.cells[3].style.color="rgba(212, 80, 78, "+d*1.5+")":l.cells[3].style.color="rgba(81, 246, 160, "+d*1.5+")",l.addEventListener("click",function(){rs(n,a.mark_price)})}}function Xe(h){const e=h.clientWidth,s=h.clientHeight;(h.width!==e||h.height!==s)&&(h.width=e,h.height=s)}let ds=[{id:"canvas1",overlayId:"overlay-canvas1"},{id:"canvas2",overlayId:"overlay-canvas2"},{id:"canvas3",overlayId:null},{id:"canvas4",overlayId:null}],us=ds.map(h=>{let e=document.querySelector(`#${h.id}`);Xe(e);let s=e.getContext("2d"),i=null,n=null;return h.overlayId&&(i=document.querySelector(`#${h.overlayId}`),Xe(i),n=i.getContext("2d")),{ctx:s,canvas:e,width:e.width,height:e.height,overlayCtx:n,overlayCanvas:i}});const ms=new os,He=new Ue(us);function fs(h,e){ps(h).then(([s,i])=>{ms.createWebSocket(h,n=>He.updateData(n)),He.startNew(h,s,i,e),document.querySelector("#ticksize-select").dispatchEvent(new Event("change")),document.querySelector("#tickerInfo-name").textContent=h})}async function ps(h){let i=(await(await fetch("https://fapi.binance.com/fapi/v1/exchangeInfo")).json()).symbols.find(n=>n.symbol===h);return i?[i.filters[0].tickSize,i.filters[2].minQty]:null}
