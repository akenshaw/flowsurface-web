var Ue=Object.defineProperty;var Qe=(l,e,i)=>e in l?Ue(l,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[e]=i;var T=(l,e,i)=>(Qe(l,typeof e!="symbol"?e+"":e,i),i),Ne=(l,e,i)=>{if(!e.has(l))throw TypeError("Cannot "+i)};var t=(l,e,i)=>(Ne(l,e,"read from private field"),i?i.call(l):e.get(l)),r=(l,e,i)=>{if(e.has(l))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(l):e.set(l,i)},o=(l,e,i,s)=>(Ne(l,e,"write to private field"),s?s.call(l,i):e.set(l,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}})();let Xt;var v,k,x,Ot,_,M,ge,w,wt,Yt,kt,Y,St,Tt,xt,D,Q,_t,Ie;class Ke{constructor(e){T(this,"zoomYLevel",.2222);T(this,"zoomXLevel",0);r(this,v,void 0);r(this,k,void 0);r(this,x,void 0);r(this,Ot,void 0);r(this,_,void 0);r(this,M,void 0);r(this,ge,void 0);T(this,"minQty");T(this,"initialPrice");r(this,w,void 0);r(this,wt,void 0);r(this,Yt,!1);r(this,kt,void 0);r(this,Y,!0);r(this,St,void 0);r(this,Tt,!0);r(this,xt,!0);r(this,D,!1);r(this,Q,!1);r(this,_t,!1);r(this,Ie,!1);o(this,v,new Re(this,e[0].ctx,e[0].canvas,e[0].width,e[0].height)),o(this,x,new Ge(this,e[1].ctx,e[1].canvas,e[1].width,e[1].height)),o(this,_,new Je(this,e[2].ctx,e[2].canvas,e[2].width,e[2].height)),o(this,M,new je(this,e[3].ctx,e[3].canvas,e[3].width,e[3].height)),o(this,k,new ts(this,e[0].overlayCtx,e[0].overlayCanvas,e[0].width,e[0].height)),o(this,Ot,new es(this,e[1].overlayCtx,e[1].overlayCanvas,e[1].width,e[1].height)),t(this,k).canvas.addEventListener("mousedown",s=>{o(this,Yt,!0),o(this,kt,{x:s.clientX,y:s.clientY})}),t(this,k).canvas.addEventListener("mousemove",s=>{if(t(this,Yt)){o(this,Y,!1);let n={x:s.clientX,y:s.clientY},a=n.x-t(this,kt).x,h=n.y-t(this,kt).y;!t(this,D)&&t(this,Q)&&(o(this,D,!0),requestAnimationFrame(()=>{t(this,v).panXY(a,h),t(this,x).panY(h),t(this,_).panX(a),t(this,M).panX(a),t(this,v).updateData(t(this,w),[]),t(this,x).updateData(t(this,w),t(this,wt)),t(this,_).updateData(t(this,w)),t(this,M).updateData(t(this,w),[]),o(this,D,!1)})),o(this,kt,n),this.updateScaleBtn()}}),["mouseup","mouseleave"].forEach(s=>t(this,k).canvas.addEventListener(s,()=>o(this,Yt,!1))),t(this,k).canvas.addEventListener("wheel",s=>{s.preventDefault(),o(this,Y,!1);const n=5e-4/(.01-.001);let a=this.zoomYLevel-(s.deltaY>0?-n:n),h=this.zoomXLevel+(s.deltaY>0?-n:n);this.zoomYLevel=Math.max(0,Math.min(a,1)),this.zoomXLevel=Math.max(0,Math.min(h,1)),!t(this,D)&&t(this,Q)&&(o(this,D,!0),requestAnimationFrame(()=>{t(this,v).zoomY(this.zoomYLevel),t(this,v).zoomX(this.zoomXLevel),t(this,x).zoomY(this.zoomYLevel),t(this,_).zoomX(this.zoomXLevel),t(this,M).zoomX(this.zoomXLevel),t(this,v).updateData(t(this,w),[]),t(this,x).updateData(t(this,w),t(this,wt)),t(this,_).updateData(t(this,w)),t(this,M).updateData(t(this,w),[]),o(this,D,!1)}),this.updateScaleBtn())}),t(this,x).canvas.addEventListener("wheel",s=>{s.preventDefault(),o(this,Y,!1);const n=5e-4/(.01-.001);let a=this.zoomYLevel-(s.deltaY>0?-n:n);this.zoomYLevel=Math.max(0,Math.min(a,1)),!t(this,D)&&t(this,Q)&&(o(this,D,!0),requestAnimationFrame(()=>{t(this,v).zoomY(this.zoomYLevel),t(this,x).zoomY(this.zoomYLevel),t(this,v).updateData(t(this,w),[]),t(this,x).updateData(t(this,w),t(this,wt)),o(this,D,!1)}),this.updateScaleBtn())}),t(this,_).canvas.addEventListener("wheel",s=>{s.preventDefault(),o(this,Y,!1);const n=5e-4/(.01-.001);let a=this.zoomXLevel+(s.deltaY>0?-n:n);this.zoomXLevel=Math.max(0,Math.min(a,1)),!t(this,D)&&t(this,Q)&&(o(this,D,!0),requestAnimationFrame(()=>{t(this,v).zoomX(this.zoomXLevel),t(this,_).zoomX(this.zoomXLevel),t(this,M).zoomX(this.zoomXLevel),t(this,v).updateData(t(this,w),[]),t(this,_).updateData(t(this,w)),t(this,M).updateData(t(this,w),[]),o(this,D,!1)})),this.updateScaleBtn()}),t(this,k).canvas.addEventListener("mousemove",s=>{const n=t(this,k).canvas.getBoundingClientRect(),a=s.clientX-n.left,h=s.clientY-n.top;t(this,k).updateCrosshair(a,h)}),t(this,k).canvas.addEventListener("mouseleave",()=>t(this,k).clearCrosshair()),document.querySelectorAll("#top-nav button").forEach(s=>{s.addEventListener("click",(function(n){const a=n.target;a.id==="tf1m"||a.id==="tf3m"||a.id==="tf5m"||a.id==="tf15m"||(a.id==="cvdToggleBtn"?(a.classList.toggle("disabled"),o(this,Tt,!t(this,Tt)),t(this,M).toggleIndicator("cvd",t(this,Tt))):a.id==="oiToggleBtn"&&(a.classList.toggle("disabled"),o(this,xt,!t(this,xt)),t(this,M).toggleIndicator("oi",t(this,xt))),!t(this,Tt)&&!t(this,xt)?(document.querySelector("#canvas4").style.display="none",document.querySelector("#canvas1").style.height="90%",document.querySelector("#canvas2").style.height="90%",document.querySelector("#canvas3").style.height="10%",document.querySelector("#canvas3").style.top="90%"):(document.querySelector("#canvas4").style.display="flex",document.querySelector("#canvas1").style.height="80%",document.querySelector("#canvas2").style.height="80%",document.querySelector("#canvas3").style.height="10%",document.querySelector("#canvas3").style.top="90%"))}).bind(this))}),document.querySelector("#crosshairBtn").addEventListener("click",s=>{document.querySelector("#crosshairBtn").classList.toggle("disabled"),t(this,k).crosshairSelected=!t(this,k).crosshairSelected}),o(this,St,document.querySelector("#btn2")),t(this,St).addEventListener("click",s=>{o(this,Y,!t(this,Y)),this.updateScaleBtn()});const i=document.querySelector("#ticksize-select");i.addEventListener("change",s=>{const n=t(this,ge)*i.value;console.log("new tick size:",n),t(this,v).bucketSize=n,t(this,k).bucketSize=n,t(this,v).maxQty=0,t(this,x).bucketSize=n,t(this,Ot).bucketSize=n})}async fetchHistKlines(e,i,s,n,a){o(this,_t,!0);try{return await(await fetch(`https://fapi.binance.com/fapi/v1/klines?symbol=${e}&interval=${i}${s?"&startTime="+s:""}${n?"&endTime="+n:""}&limit=${a}`)).json()}catch(h){return console.log(h,e),NaN}}async getHistKlines(e,i,s){if(t(this,_t)){console.log("already fetching historical klines...");return}o(this,_t,!0),this.fetchHistKlines(Xt,"1m",e,i,s).then(n=>{t(this,v).resolveHistData("klines",n),t(this,_).resolveHistData("klines",n),o(this,_t,!1)})}async fetchHistTrades(e,i,s,n){try{const a=`https://fapi.binance.com/fapi/v1/aggTrades?symbol=${e}${i?"&startTime="+i:""}${s?"&endTime="+s:""}${n?"&limit="+n:""}`;return(await(await fetch(a)).json()).map(d=>({x:d.T,y:parseFloat(d.p),q:parseFloat(d.q),m:d.m}))}catch(a){return console.log(a,url),NaN}}updateScaleBtn(){t(this,Y)?(t(this,v).resetZoomAndPan(),t(this,x).resetZoomAndPan(),t(this,_).resetZoomAndPan(),t(this,M).resetZoomAndPan(),t(this,St).innerHTML='<svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 448 512"><path fill="#c8c8c8" d="M144 144v48H304V144c0-44.2-35.8-80-80-80s-80 35.8-80 80zM80 192V144C80 64.5 144.5 0 224 0s144 64.5 144 144v48h16c35.3 0 64 28.7 64 64V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V256c0-35.3 28.7-64 64-64H80z"/></svg>'):t(this,St).innerHTML='<svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 576 512"><path fill="#c8c8c8" d="M352 144c0-44.2 35.8-80 80-80s80 35.8 80 80v48c0 17.7 14.3 32 32 32s32-14.3 32-32V144C576 64.5 511.5 0 432 0S288 64.5 288 144v48H64c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V256c0-35.3-28.7-64-64-64H352V144z"/></svg>'}updateData(e){o(this,w,e.kline),o(this,wt,e.depth),t(this,v).updateData(e.kline,e.tradesBuffer),t(this,x).updateData(e.kline,e.depth),t(this,_).updateData(e.kline),t(this,M).updateData(e.kline,e.tradesBuffer)}startNew(e,i,s,n){o(this,Q,!1),Xt=e,o(this,ge,i),this.minQty=s,this.initialPrice=n,this.zoomYLevel=.2222,this.zoomXLevel=0,o(this,Y,!0),this.updateScaleBtn(),t(this,v).resetData(),t(this,x).resetData(),t(this,_).resetData(),t(this,M).resetData(),t(this,Q)||setTimeout(()=>{o(this,Q,!0)},3e3)}drawScale(e,i){t(this,Ot).drawStart(e,i)}}v=new WeakMap,k=new WeakMap,x=new WeakMap,Ot=new WeakMap,_=new WeakMap,M=new WeakMap,ge=new WeakMap,w=new WeakMap,wt=new WeakMap,Yt=new WeakMap,kt=new WeakMap,Y=new WeakMap,St=new WeakMap,Tt=new WeakMap,xt=new WeakMap,D=new WeakMap,Q=new WeakMap,_t=new WeakMap,Ie=new WeakMap;var ct,f,K,A,E,dt,q,R,xe,V,Mt,Zt,C,Wt,$t,ut,Ut,Qt,N,mt,Dt,Ct,Lt,Kt,et,st;class Re{constructor(e,i,s,n,a){r(this,ct,void 0);r(this,f,void 0);r(this,K,void 0);r(this,A,void 0);r(this,E,[]);r(this,dt,[]);r(this,q,void 0);r(this,R,[]);r(this,xe,void 0);r(this,V,void 0);r(this,Mt,void 0);r(this,Zt,60);r(this,C,void 0);r(this,Wt,.997);r(this,$t,1.003);r(this,ut,30);T(this,"bucketSize");r(this,Ut,void 0);T(this,"maxQty");r(this,Qt,!0);r(this,N,0);r(this,mt,0);r(this,Dt,null);r(this,Ct,[]);r(this,Lt,!1);r(this,Kt,!1);r(this,et,!1);r(this,st,void 0);o(this,ct,e),o(this,f,i),this.canvas=s,o(this,K,n),o(this,A,a),o(this,C,Math.round(1*60*1e3/(30*60*1e3)*(t(this,K)-t(this,Zt))))}panXY(e,i){o(this,Qt,!1);const s=t(this,A)/(t(this,Mt)-t(this,V)),n=i/s;o(this,mt,t(this,mt)+n),o(this,N,t(this,N)+e<0?0:t(this,N)+e)}zoomY(e){const h=.001+.009000000000000001*e,c=.001+(.01-.001)*e;o(this,Wt,Math.round((1-h)*1e4)/1e4),o(this,$t,Math.round((1+c)*1e4)/1e4)}zoomX(e){o(this,ut,Math.round(30+-20*e)),o(this,C,Math.round(1*60*1e3/(t(this,ut)*60*1e3)*(t(this,K)-t(this,Zt))))}resetZoomAndPan(){o(this,Qt,!0),o(this,N,0),o(this,mt,0),o(this,Wt,.997),o(this,$t,1.003),o(this,ut,30),o(this,C,Math.round(1*60*1e3/(t(this,ut)*60*1e3)*(t(this,K)-t(this,Zt))))}resetData(){o(this,E,[]),o(this,dt,[]),o(this,q,null),o(this,R,[]),o(this,xe,null),o(this,V,null),o(this,Mt,null),o(this,Qt,!0),o(this,N,0),o(this,mt,0),o(this,Dt,null),o(this,Lt,!1),o(this,Kt,!1),o(this,et,!1),o(this,Ut,t(this,ct).minQty)}resolveHistData(e,i){e==="klines"&&(o(this,Lt,!0),i.forEach(s=>{const[n,a,h,c,d,,u]=s,m={startTime:n,openPrice:a,highPrice:h,lowPrice:c,closePrice:d,endTime:u};t(this,E).unshift(m),t(this,dt).unshift([])}))}async getHistTrades(e){if(t(this,et)){console.log("already fetching historical trades...");return}o(this,et,!0);let i=t(this,q).startTime;const s=Date.now();let n=[],a=0;console.log("getting current trades...");do try{const h=await t(this,ct).fetchHistTrades(e,i,s,1e3);n=n.concat(h),a=h[h.length-1].x,i=a+1,console.log("fetched",h.length,"trades")}catch(h){console.log(h,i,null);break}while(a<s);o(this,R,n);for(let h=0;h<t(this,E).length;h++){const c=t(this,E)[h];let d=c.startTime;const u=c.endTime;let m=[],g=0;console.log("getting historical trades:",h+1,"of",t(this,E).length,"klines...");do{if(e!=Xt){console.log("stopped fetching historical trades for",e),o(this,et,!1);return}try{const b=await t(this,ct).fetchHistTrades(Xt,d,u,1e3);m=m.concat(b),g=b[b.length-1].x,d=g+1,console.log("fetched",b.length,"trades"),await new Promise(rt=>setTimeout(rt,500))}catch(b){console.log(b,d,u);break}}while(g<u);t(this,dt)[h]=m}o(this,et,!1),o(this,Kt,!0)}updateData(e,i){const{E:s,k:{t:n,o:a,h,l:c,c:d,T:u}}=e;(s>t(this,Dt)||t(this,Dt)===null)&&(t(this,q)&&t(this,q).endTime!==u&&(t(this,E).push(t(this,q)),t(this,dt).push(t(this,R)),o(this,R,[])),o(this,Dt,u)),o(this,q,{startTime:n,openPrice:a,highPrice:h,lowPrice:c,closePrice:d,endTime:u});for(let m=0;m<i.length;m++){const g=i[m];if(g.x>=n&&g.x<u)t(this,R).push(g);else if(g.x>=u){t(this,Ct).push(...i.slice(m));break}}if(t(this,Ct).length>0&&o(this,Ct,t(this,Ct).filter(m=>m.x>=n&&m.x<u?(t(this,R).push(m),!1):!0)),o(this,V,Math.min((Number(h)+Number(c))/2*t(this,Wt),c)+t(this,mt)),o(this,Mt,Math.max((Number(h)+Number(c))/2*t(this,$t),h)+t(this,mt)),o(this,st,t(this,A)/(t(this,Mt)-t(this,V))),this.drawStart(),t(this,E).length<60&&!t(this,Lt)){console.log("getting historical klines...");const m=null,g=60-t(this,E).length,b=t(this,q).startTime-1;t(this,ct).getHistKlines(m,b,g)}t(this,Lt)&&!t(this,et)&&!t(this,Kt)&&this.getHistTrades(Xt)}drawStart(){t(this,f).clearRect(0,0,t(this,K),t(this,A));const e=Math.round(t(this,K)-t(this,C)),i=t(this,ut)*60*1e3,s=t(this,q).startTime-i,n=0-t(this,N),a=t(this,K)-t(this,N);this.maxQty=0,t(this,E).length>0&&t(this,E).forEach((h,c)=>{const d=Math.round((h.startTime-s)/i*e);d>=n&&d<=a&&this.drawDataPoint(t(this,dt)[c],h,d+t(this,N))}),this.drawDataPoint(t(this,R),t(this,q),e+t(this,N))}drawDataPoint(e,i,s){if(e){const u=[].concat(...e).reduce((g,b)=>{const rt=Math.round(b.y/this.bucketSize)*this.bucketSize,tt=`${rt}-${b.m}`;return g[tt]||(g[tt]={...b,y:rt,q:0}),g[tt].q+=b.q,g},{}),m=Math.max(...Object.values(u).map(g=>g.q));this.maxQty=m>this.maxQty?m:this.maxQty,Object.values(u).forEach(g=>{const b=Math.round(t(this,A)-(g.y-t(this,V))*t(this,st)),rt=this.scaleQuantity(g.q);this.drawTradesAt(s,b,g.m,rt)})}const n=Math.round(t(this,A)-(i.openPrice-t(this,V))*t(this,st)),a=Math.round(t(this,A)-(i.highPrice-t(this,V))*t(this,st)),h=Math.round(t(this,A)-(i.lowPrice-t(this,V))*t(this,st)),c=Math.round(t(this,A)-(i.closePrice-t(this,V))*t(this,st));this.drawKlineAt(s,a-2),this.drawKlineAt(s,h+2),t(this,f).beginPath(),t(this,f).moveTo(s+t(this,C)/2,n),t(this,f).lineTo(s+t(this,C)/2,c),t(this,f).shadowColor=c<n?"rgba(155, 230, 209, 0.5)":"rgba(230, 161, 160, 0.5)",t(this,f).shadowBlur=5,t(this,f).strokeStyle=c<n?"rgba(155, 230, 209, 0.5)":"rgba(230, 161, 160, 0.5)",t(this,f).stroke(),t(this,f).shadowColor="transparent",t(this,f).shadowBlur=0}drawKlineAt(e,i){t(this,f).beginPath(),t(this,f).moveTo(e+5,i),t(this,f).lineTo(e+t(this,C)-5,i),t(this,f).strokeStyle="rgba(200, 200, 200, 0.5)",t(this,f).stroke()}drawTradesAt(e,i,s,n){t(this,f).beginPath(),s?(t(this,f).moveTo(e-4+t(this,C)/2,i),t(this,f).lineTo(e-4+t(this,C)/2-n,i),t(this,f).strokeStyle="rgba(192, 80, 77, 1)"):(t(this,f).moveTo(e+4+t(this,C)/2,i),t(this,f).lineTo(e+4+t(this,C)/2+n,i),t(this,f).strokeStyle="rgba(81, 205, 160, 1)"),t(this,f).stroke()}scaleQuantity(e){const s=t(this,C)/2-4;return 0+(e-t(this,Ut))*(s-0)/(this.maxQty-t(this,Ut))}}ct=new WeakMap,f=new WeakMap,K=new WeakMap,A=new WeakMap,E=new WeakMap,dt=new WeakMap,q=new WeakMap,R=new WeakMap,xe=new WeakMap,V=new WeakMap,Mt=new WeakMap,Zt=new WeakMap,C=new WeakMap,Wt=new WeakMap,$t=new WeakMap,ut=new WeakMap,Ut=new WeakMap,Qt=new WeakMap,N=new WeakMap,mt=new WeakMap,Dt=new WeakMap,Ct=new WeakMap,Lt=new WeakMap,Kt=new WeakMap,et=new WeakMap,st=new WeakMap;var Rt,p,Pt,Z,Gt,it,X,ft,Jt,jt,te,zt,ye,ee,pt;class Ge{constructor(e,i,s,n,a){r(this,Rt,void 0);r(this,p,void 0);r(this,Pt,void 0);r(this,Z,void 0);r(this,Gt,void 0);r(this,it,void 0);r(this,X,void 0);r(this,ft,void 0);r(this,Jt,.997);r(this,jt,1.003);T(this,"bucketSize");r(this,te,!0);r(this,zt,0);r(this,ye,void 0);r(this,ee,void 0);r(this,pt,void 0);o(this,Rt,e),o(this,p,i),this.canvas=s,o(this,Pt,n),o(this,Z,a)}panY(e){o(this,te,!1);const i=t(this,Z)/(t(this,ft)-t(this,X)),s=e/i;o(this,zt,t(this,zt)+s)}zoomY(e){const h=.001+.009000000000000001*e,c=.001+(.01-.001)*e;o(this,Jt,Math.round((1-h)*1e4)/1e4),o(this,jt,Math.round((1+c)*1e4)/1e4)}resetZoomAndPan(){o(this,te,!0),o(this,Jt,.997),o(this,jt,1.003),o(this,zt,0)}resetData(){o(this,Gt,null),o(this,it,null),o(this,X,null),o(this,ft,null),o(this,te,!0),o(this,ye,Math.round(1e6/t(this,Rt).initialPrice)),o(this,ee,t(this,ye))}updateData(e,i){const{k:{o:s,h:n,l:a,c:h}}=e;o(this,Gt,{openPrice:s,highPrice:n,lowPrice:a,closePrice:h});const{asks:c,bids:d}=i;o(this,it,{asks:c,bids:d}),o(this,X,Math.min((Number(n)+Number(a))/2*t(this,Jt),a)+t(this,zt)),o(this,ft,Math.max((Number(n)+Number(a))/2*t(this,jt),n)+t(this,zt)),o(this,pt,t(this,Z)/(t(this,ft)-t(this,X))),this.drawStart(),t(this,Rt).drawScale(t(this,X),t(this,ft))}drawStart(){t(this,p).clearRect(0,0,t(this,Pt),t(this,Z));const{closePrice:e,openPrice:i}=t(this,Gt),s=Math.round(t(this,Z)-(e-t(this,X))*t(this,pt)),n=Math.round(t(this,Z)-(i-t(this,X))*t(this,pt));if(this.maxQuantity=t(this,ee),t(this,it).asks&&t(this,it).bids){const m=tt=>tt.reduce((lt,Nt)=>{const Le=Math.round(Nt[0]/this.bucketSize)*this.bucketSize;return lt[Le]||(lt[Le]=0),lt[Le]+=parseFloat(Nt[1]),lt},{}),g=m(t(this,it).asks),b=m(t(this,it).bids),rt=[...Object.values(g),...Object.values(b)];this.maxQuantity=Math.max(t(this,ee),...rt),Object.entries(g).forEach(([tt,lt])=>{const Nt=Math.round(t(this,Z)-(tt-t(this,X))*t(this,pt));this.drawLineAt(Nt,"#C0504E",lt)}),Object.entries(b).forEach(([tt,lt])=>{const Nt=Math.round(t(this,Z)-(tt-t(this,X))*t(this,pt));this.drawLineAt(Nt,"#51CDA0",lt)})}t(this,p).font="10px monospace",t(this,p).fillStyle="#c8c8c8";let a=Math.round(this.maxQuantity),h=t(this,p).measureText(a).width;t(this,p).fillText(a,t(this,Pt)-5-h,20);const c={"#C0504E":"rgba(192, 80, 78, 0.5)","#51CDA0":"rgba(81, 205, 160, 0.5)","#c8c8c8":"rgba(200, 200, 200, 0.5)"},d=s>n?"#C0504E":s<n?"#51CDA0":"#c8c8c8",u=c[d];this.drawTextWithBackground(s,Number(e),"#212121",d,u)}drawLineAt(e,i,s){const n=s/this.maxQuantity*(t(this,Pt)-60);t(this,p).beginPath(),t(this,p).moveTo(60,e),t(this,p).lineTo(n+60,e),t(this,p).strokeStyle=i,t(this,p).lineWidth=1,t(this,p).stroke()}drawTextWithBackground(e,i,s,n,a){t(this,p).font="11px monospace";const h=t(this,p).measureText(i).width;t(this,p).shadowColor=a,t(this,p).shadowBlur=5,t(this,p).fillStyle=n,t(this,p).fillRect(3,e-10,h+4,12),t(this,p).shadowColor="transparent",t(this,p).shadowBlur=0,t(this,p).fillStyle=s,t(this,p).fillText(i,5,e)}}Rt=new WeakMap,p=new WeakMap,Pt=new WeakMap,Z=new WeakMap,Gt=new WeakMap,it=new WeakMap,X=new WeakMap,ft=new WeakMap,Jt=new WeakMap,jt=new WeakMap,te=new WeakMap,zt=new WeakMap,ye=new WeakMap,ee=new WeakMap,pt=new WeakMap;var _e,y,G,I,Et,ot,se,ie,oe,H,nt,F,ve,ne;class Je{constructor(e,i,s,n,a){r(this,_e,void 0);r(this,y,void 0);r(this,G,void 0);r(this,I,void 0);r(this,Et,[]);r(this,ot,void 0);r(this,se,void 0);r(this,ie,void 0);r(this,oe,60);r(this,H,void 0);r(this,nt,30);r(this,F,0);r(this,ve,!1);r(this,ne,void 0);o(this,_e,e),o(this,y,i),this.canvas=s,o(this,G,n),o(this,I,a),o(this,H,Math.round(1*60*1e3/(t(this,nt)*60*1e3)*(t(this,G)-t(this,oe))))}panX(e){o(this,F,t(this,F)+e<0?0:t(this,F)+e)}zoomX(e){o(this,nt,30+-20*e),o(this,H,Math.round(1*60*1e3/(t(this,nt)*60*1e3)*(t(this,G)-t(this,oe))))}resetZoomAndPan(){o(this,F,0),o(this,nt,30),o(this,H,Math.round(1*60*1e3/(t(this,nt)*60*1e3)*(t(this,G)-t(this,oe))))}resetData(){o(this,Et,[]),o(this,ot,null),o(this,se,null),o(this,ie,null),o(this,F,0),o(this,ve,!1)}resolveHistData(e,i){e==="klines"&&(o(this,ve,!0),i.forEach(s=>{const[n,,,,,a,h,,,c,,,]=s,d={startTime:n,endTime:h,totalVolume:a,buyVolume:c,sellVolume:a-c};t(this,Et).unshift(d)}))}updateData(e){const{k:{t:i,T:s,v:n,V:a}}=e,h=n-a;t(this,se)!==i&&(t(this,ot)&&t(this,Et).push(t(this,ot)),o(this,se,i)),o(this,ot,{startTime:i,endTime:s,buyVolume:a,sellVolume:h}),this.drawStart()}drawStart(){t(this,y).clearRect(0,0,t(this,G),t(this,I));const e=Math.round(t(this,G)-t(this,H)),i=t(this,nt)*60*1e3,s=t(this,ot).startTime-i,n=0-t(this,F),a=t(this,G)-t(this,F),h=t(this,Et).filter(c=>{const d=Math.round((c.startTime-s)/i*e);return d>=n&&d<=a});o(this,ie,h.reduce((c,d)=>Math.max(c,d.buyVolume,d.sellVolume),0)),o(this,ne,(t(this,I)-20)/t(this,ie)),h.length>0&&h.forEach(c=>{const d=Math.round((c.startTime-s)/i*e);this.drawDataPoint(c,d+t(this,F))}),this.drawDataPoint(t(this,ot),e+t(this,F))}drawDataPoint(e,i){const s=Math.max(0,Math.min(t(this,I)-20,Math.round(t(this,I)-20-e.buyVolume*t(this,ne)))),n=Math.max(0,Math.min(t(this,I)-20,Math.round(t(this,I)-20-e.sellVolume*t(this,ne))));t(this,y).beginPath(),t(this,y).moveTo(i,0),t(this,y).lineTo(i,t(this,I)-20),t(this,y).strokeStyle="rgba(200, 200, 200, 0.4)",t(this,y).lineWidth=1,t(this,y).stroke(),this.drawTimeLabel(i,e.startTime),this.drawKlineAt(i+t(this,H)/2+t(this,H)/8,s,"#51CDA0","rgba(81, 205, 160, 0.4)"),this.drawKlineAt(i+t(this,H)/2-t(this,H)/8,n,"#C0504E","rgba(192, 80, 77, 0.4)")}drawKlineAt(e,i,s,n){t(this,y).beginPath(),t(this,y).moveTo(e,t(this,I)-20),t(this,y).lineTo(e,i),t(this,y).strokeStyle=s,t(this,y).lineWidth=t(this,H)/6,t(this,y).shadowColor=n,t(this,y).shadowBlur=3,t(this,y).stroke(),t(this,y).shadowColor="transparent",t(this,y).shadowBlur=0}drawTimeLabel(e,i){const s=new Date(i),n=s.getHours().toString().padStart(2,"0")+":"+s.getMinutes().toString().padStart(2,"0");t(this,y).font="11px monospace",t(this,y).fillStyle="#c8c8c8",t(this,y).fillText(n,e,t(this,I)-5)}}_e=new WeakMap,y=new WeakMap,G=new WeakMap,I=new WeakMap,Et=new WeakMap,ot=new WeakMap,se=new WeakMap,ie=new WeakMap,oe=new WeakMap,H=new WeakMap,nt=new WeakMap,F=new WeakMap,ve=new WeakMap,ne=new WeakMap;var Me,L,J,O,P,W,Be,$,ae,he,It,re,j,le,U,at,z,ce,de,Bt,be,gt;class je{constructor(e,i,s,n,a){r(this,Me,void 0);r(this,L,void 0);r(this,J,void 0);r(this,O,void 0);r(this,P,[]);r(this,W,void 0);r(this,Be,void 0);r(this,$,[]);r(this,ae,void 0);r(this,he,void 0);r(this,It,void 0);r(this,re,void 0);r(this,j,void 0);r(this,le,60);r(this,U,void 0);r(this,at,30);r(this,z,0);r(this,ce,0);r(this,de,!0);r(this,Bt,!0);r(this,be,void 0);r(this,gt,void 0);o(this,Me,e),o(this,L,i),this.canvas=s,o(this,J,n),o(this,O,a),o(this,U,Math.round(1*60*1e3/(t(this,at)*60*1e3)*(t(this,J)-t(this,le))))}panX(e){o(this,z,t(this,z)+e<0?0:t(this,z)+e)}zoomX(e){o(this,at,30+-20*e),o(this,U,Math.round(1*60*1e3/(t(this,at)*60*1e3)*(t(this,J)-t(this,le))))}resetZoomAndPan(){o(this,z,0),o(this,at,30),o(this,U,Math.round(1*60*1e3/(t(this,at)*60*1e3)*(t(this,J)-t(this,le))))}resetData(){o(this,P,[]),o(this,$,[]),o(this,W,null),o(this,ae,null),o(this,he,null),o(this,It,null),o(this,re,null),o(this,j,null),o(this,ce,0),o(this,z,0)}toggleIndicator(e,i){e==="oi"?o(this,de,i):e==="cvd"&&o(this,Bt,i)}async updateData(e,i){const{k:{t:s,T:n}}=e;if(o(this,ce,t(this,ce)+i.reduce((a,h)=>h.m?a-h.q:a+h.q,0)),t(this,ae)!==s&&(t(this,W)&&(this.fetchOI(Xt).then(a=>{t(this,$).push(a)}),t(this,P).push(t(this,W)),t(this,P).length>60&&(t(this,P).shift(),t(this,$).shift())),o(this,ae,s)),o(this,W,{startTime:s,endTime:n,cumVolumeDelta:t(this,ce)}),t(this,de)||t(this,Bt)){o(this,he,t(this,$).length>0?Math.max(...t(this,$).map(Number))*1.001:0),o(this,It,t(this,$).length>0?Math.min(...t(this,$).map(Number))*.999:0);const a=t(this,P).map(h=>h.cumVolumeDelta);o(this,re,(Math.max(...a,t(this,W).cumVolumeDelta)||0)*1.001),o(this,j,(Math.min(...a,t(this,W).cumVolumeDelta)||0)*.999),o(this,be,t(this,O)/(t(this,he)-t(this,It))),o(this,gt,t(this,O)/(t(this,re)-t(this,j))),this.drawStart()}}drawStart(){t(this,L).clearRect(0,0,t(this,J),t(this,O));const e=Math.round(t(this,J)-t(this,U)),i=t(this,at)*60*1e3,s=t(this,W).startTime-i,n=0-t(this,z),a=t(this,J)-t(this,z);if(t(this,P).length>0&&t(this,P).forEach((h,c)=>{const d=Math.round((h.startTime-s)/i*e);if(d>=n&&d<=a){if(t(this,de)){const u=t(this,O)-(t(this,$)[c]-t(this,It))*t(this,be);this.drawOIPoint(d+t(this,z),u)}if(t(this,Bt)){const u=t(this,O)-(h.cumVolumeDelta-t(this,j))*t(this,gt);if(c>0){const m=t(this,O)-(t(this,P)[c-1].cumVolumeDelta-t(this,j))*t(this,gt);this.drawCVDLine(d+t(this,z),m,d+t(this,U)+t(this,z),u)}}}}),t(this,Bt)){const h=e+t(this,z);if(h>=n&&h<=a){const c=t(this,O)-(t(this,W).cumVolumeDelta-t(this,j))*t(this,gt);if(t(this,P).length>0){const d=t(this,O)-(t(this,P)[t(this,P).length-1].cumVolumeDelta-t(this,j))*t(this,gt);this.drawCVDLine(h,d,h+t(this,U),c)}else this.drawCVDLine(h,0,h+t(this,U),c)}}}drawCVDLine(e,i,s,n){t(this,L).beginPath(),t(this,L).moveTo(e,i),t(this,L).lineTo(s,n),t(this,L).lineWidth=2,t(this,L).strokeStyle="rgba(238, 216, 139, 0.3)",t(this,L).stroke()}drawOIPoint(e,i){t(this,L).beginPath(),t(this,L).arc(e+t(this,U),i,2,0,2*Math.PI),t(this,L).fillStyle="#c8c8c8",t(this,L).fill()}async fetchOI(e){return(await(await fetch(`https://fapi.binance.com/fapi/v1/openInterest?symbol=${e}`)).json()).openInterest}}Me=new WeakMap,L=new WeakMap,J=new WeakMap,O=new WeakMap,P=new WeakMap,W=new WeakMap,Be=new WeakMap,$=new WeakMap,ae=new WeakMap,he=new WeakMap,It=new WeakMap,re=new WeakMap,j=new WeakMap,le=new WeakMap,U=new WeakMap,at=new WeakMap,z=new WeakMap,ce=new WeakMap,de=new WeakMap,Bt=new WeakMap,be=new WeakMap,gt=new WeakMap;var De,S,At,qt,Ae,qe;class ts{constructor(e,i,s,n,a){r(this,De,void 0);r(this,S,void 0);r(this,At,void 0);r(this,qt,void 0);r(this,Ae,void 0);r(this,qe,void 0);T(this,"crosshairSelected",!1);o(this,De,e),o(this,S,i),this.canvas=s,o(this,At,n),o(this,qt,a)}updateCrosshair(e,i){this.crosshairSelected&&(t(this,S).clearRect(0,0,t(this,At),t(this,qt)),this.drawCrosshair(e,i))}drawCrosshair(e,i){t(this,S).beginPath(),t(this,S).moveTo(e,0),t(this,S).lineTo(e,t(this,qt)),t(this,S).strokeStyle="rgba(200, 200, 200, 0.5)",t(this,S).stroke(),t(this,S).beginPath(),t(this,S).moveTo(0,i),t(this,S).lineTo(t(this,At),i),t(this,S).strokeStyle="rgba(200, 200, 200, 0.5)",t(this,S).stroke()}clearCrosshair(){t(this,S).clearRect(0,0,t(this,At),t(this,qt))}}De=new WeakMap,S=new WeakMap,At=new WeakMap,qt=new WeakMap,Ae=new WeakMap,qe=new WeakMap;var Ce,yt,we,Vt,ke,Se;class es{constructor(e,i,s,n,a){r(this,Ce,void 0);r(this,yt,void 0);r(this,we,void 0);r(this,Vt,void 0);T(this,"bucketSize");r(this,ke,void 0);r(this,Se,void 0);o(this,Ce,e),o(this,yt,i),this.canvas=s,o(this,we,n),o(this,Vt,a)}drawStart(e,i){if(e===t(this,ke)&&i===t(this,Se))return;t(this,yt).clearRect(0,0,t(this,we),t(this,Vt)),o(this,ke,e),o(this,Se,i);const s=t(this,Vt)/(i-e),n=20,a=(i-e)/n;for(let h=0;h<=n;h++){let c=e+h*a;c=Number((Math.round(c/this.bucketSize)*this.bucketSize).toFixed(4));const d=Math.round(t(this,Vt)-(c-e)*s);this.drawTextAt(d,Number(c.toFixed(4)),"#c8c8c8")}}drawTextAt(e,i,s){t(this,yt).font="11px monospace",t(this,yt).fillStyle=s,t(this,yt).fillText(i,5,e)}}Ce=new WeakMap,yt=new WeakMap,we=new WeakMap,Vt=new WeakMap,ke=new WeakMap,Se=new WeakMap;async function Ye(){let e=Date.now()-25*60*60*1e3,i=e+60*60*1e3,s={};const[n,a]=await Promise.all([os(),ns()]),h=Object.keys(n).filter(u=>!["BTCSTUSDT","CVCUSDT","DOGEUSDC","COCOSUSDT","BNBBTC","ETHBTC","RAYUSDT","HNTUSDT","SCUSDT","WIFUSDT","BTSUSDT","TOMOUSDT","FTTUSDT","SRMUSDT"].includes(u)&&!u.includes("_")),c=h.map(u=>ss(u,e,i)),d=await Promise.all(c);return h.forEach((u,m)=>{a.hasOwnProperty(u)&&(s[u]={...n[u],...a[u],...d[m]})}),s}async function ss(l,e,i){let s;try{s=await is(l);const a=await(await fetch(`https://fapi.binance.com/futures/data/openInterestHist?symbol=${l}&period=30m&limit=1&startTime=${e}&endTime=${i}`)).json(),h=Math.round(a[0].sumOpenInterest),c=Math.round((s-h)/h*1e4)/100;return{open_interest:s,OI_24hrChange:c}}catch{return{open_interest:s,OI_24hrChange:NaN}}}async function is(l){try{const i=await(await fetch(`https://fapi.binance.com/fapi/v1/openInterest?symbol=${l}`)).json();return Number(i.openInterest)}catch(e){return console.log(e,l),NaN}}async function os(){let l={};const i=await(await fetch("https://fapi.binance.com/fapi/v1/premiumIndex")).json();for(let s of i){let n=s.symbol,a=parseFloat(s.lastFundingRate)*100,h=parseFloat(s.markPrice);l[n]={funding_rate:parseFloat(a.toFixed(3)),mark_price:Math.round(h*1e4)/1e4}}return l}async function ns(){let l={};const i=await(await fetch("https://fapi.binance.com/fapi/v1/ticker/24hr")).json();for(let s of i){let n=s.symbol,a=s.quoteVolume,h=s.priceChangePercent;l[n]={change:Number(h),volume:Math.round(a)}}return l}var vt,bt,ue,B,me;class as{constructor(){r(this,vt,void 0);r(this,bt,[]);r(this,ue,[]);r(this,B,void 0);r(this,me,!0);T(this,"last_update_id");T(this,"order_book");console.log("Initializing WebSocketService")}createWebSocket(e,i){t(this,vt)&&t(this,vt).readyState===1&&(console.log("Closing existing websocket connection for symbol:",t(this,B).toUpperCase()),this.order_book.shouldRefresh=!1,t(this,vt).close(),o(this,me,!0),this.order_book=null,o(this,bt,[]),o(this,ue,[])),console.log("Creating websocket connection for symbol:",e),o(this,B,e.toLowerCase()),Ee(t(this,B)).then(s=>{o(this,vt,new WebSocket(`wss://fstream.binance.com/stream?streams=${t(this,B)}@aggTrade/${t(this,B)}@depth@100ms/${t(this,B)}@kline_1m`)),this.setupEventListeners(t(this,vt),i),this.last_update_id=s.lastUpdateId,this.order_book=new hs(t(this,B),s.bids,s.asks)}).catch(s=>{console.error("Error initializing the order book:",s)})}setupEventListeners(e,i){e.addEventListener("open",()=>{this.order_book.refresh_order_book(t(this,B)),console.log("New WebSocket connection opened")}),e.addEventListener("close",()=>{console.log("Previous WebSocket connection was closed")});let s=!1;e.addEventListener("message",async n=>{let a=JSON.parse(n.data);if(a.stream.endsWith("@aggTrade")){let h=a.data;t(this,bt).push({x:h.T,y:parseFloat(h.p),q:parseFloat(h.q),m:h.m})}else if(a.stream.endsWith("@depth@100ms")){if(s){console.log("isHandlingDepth:",s);return}s=!0,await this.handleDepth(a.data),s=!1,i({kline:t(this,ue),depth:this.order_book.order_book,tradesBuffer:t(this,bt)}),o(this,bt,[])}else a.stream.endsWith("@kline_1m")&&o(this,ue,a.data)})}async handleDepth(e){let i=e.u,s=e.U,n=e.pu;if(i<this.last_update_id){console.log("finalUpdateId < last_update_id",i,this.last_update_id);return}if(t(this,me))if(s<=this.last_update_id&&this.last_update_id<=i)console.log("First processed event succeeded"),o(this,me,!1);else{await this.reinitializeOrderBook(t(this,B));return}else if(n!=this.last_update_id){await this.reinitializeOrderBook(t(this,B));return}await this.order_book.update_order_book(e.b,e.a),this.last_update_id=i}async reinitializeOrderBook(e){console.log("Out of sync, reinitializing order book...");const i=await Ee(e);this.last_update_id=i.lastUpdateId,this.order_book.order_book=this.order_book.initialize_order_book(i.bids,i.asks),o(this,bt,[])}}vt=new WeakMap,bt=new WeakMap,ue=new WeakMap,B=new WeakMap,me=new WeakMap;class hs{constructor(e,i,s){T(this,"currentSymbol");T(this,"order_book");T(this,"shouldRefresh",!0);console.log("initializing new OrderBook class"),this.currentSymbol=e,this.order_book=this.initialize_order_book(i,s)}initialize_order_book(e,i){let s=e.map(a=>a.map(Number)),n=i.map(a=>a.map(Number));return{bids:s,asks:n}}async refresh_order_book(e){let i=new AbortController,s=setInterval(async()=>{if(!this.shouldRefresh||e!==this.currentSymbol)clearInterval(s),i.abort();else{i=new AbortController;try{let n=await Ee(e,{signal:i.signal});this.order_book=this.initialize_order_book(n.bids,n.asks)}catch(n){n.name==="AbortError"?console.log("Fetch operation aborted"):console.error("Error fetching order book:",n)}}},6e3)}async update_order_book(e,i){let s=e.map(a=>a.map(Number)),n=i.map(a=>a.map(Number));[this.order_book.bids,this.order_book.asks]=await this.prepare_order_book(this.order_book.bids,this.order_book.asks,s,n)}async prepare_order_book(e,i,s,n){try{const a=new Map([...e,...s].filter(u=>u[0]>=e[e.length-1][0])),h=new Map([...i,...n].filter(u=>u[0]<=i[i.length-1][0]));let c=Array.from(a.entries()).filter(u=>u[1]!==0).sort((u,m)=>m[0]-u[0]),d=Array.from(h.entries()).filter(u=>u[1]!==0).sort((u,m)=>u[0]-m[0]);return c[0][0]>=d[0][0]&&(c=c.filter(u=>u[0]<s[s.length-1][0]),d=d.filter(u=>u[0]>n[0][0]),console.log("Error: bids[0] >= asks[0], rehandled to: ",c[0][0],d[0][0])),[c,d]}catch(a){return console.error("Error preparing order book:",a),[s,n]}}}async function Ee(l){return await(await fetch(`https://fapi.binance.com/fapi/v1/depth?symbol=${l}&limit=500`)).json()}const Pe=["btn1","btn2","btn3","btn4"],rs=["tickers-menu","menu2","menu3","settings-menu"],ls=[We,Xe,Xe,us];for(let l=0;l<Pe.length;l++){const e=document.getElementById(Pe[l]);e.addEventListener("click",ls[l]),e.addEventListener("click",function(){pe(Pe[l],rs[l])})}const Ht=document.getElementById("tickers-menu"),Ft=document.getElementById("settings-menu");let Ve=document.getElementById("ticker-search"),Te;Ve.addEventListener("keyup",function(){Te=this.value.toLowerCase();let l=document.querySelectorAll("#ticker-table tbody tr");for(let e of l)e.cells[0].textContent.toLowerCase().includes(Te)?e.style.display="":e.style.display="none"});function cs(l,e){gs(l,e),console.log("canvas was started with symbol: "+l),Ve.value="",Te="";let i=document.querySelectorAll("#ticker-table tbody tr");for(let s of i)s.style.display="";We()}function ds(){const l=new Date,e=l.getHours().toString().padStart(2,"0"),i=l.getMinutes().toString().padStart(2,"0"),s=l.getSeconds().toString().padStart(2,"0");return e+":"+i+":"+s}function Ze(){const l=document.getElementById("tickers-update-info");l.textContent="Last updated at "+ds()}const ht=document.getElementById("tickers-update-btn");ht.addEventListener("click",function(){ht.className="loading-animation",ht.disabled=!0,Ye().then(l=>{ht.className="",$e(l),Ze(),ht.disabled=!1})});window.onload=function(){ht.className="loading-animation",ht.disabled=!0,Ye().then(l=>{ht.className="",$e(l),Ze(),ht.disabled=!1})};function Xe(){console.log("show menu")}function We(){Ve.value="",Te="";let l=document.querySelectorAll("#ticker-table tbody tr");for(let e of l)e.style.display="";Ht.style.display=Ht.style.display==="none"?"block":"none",pe("btn1","tickers-menu"),Ht.style.display==="block"?document.addEventListener("click",fe):document.removeEventListener("click",fe)}function us(){Ft.style.display=Ft.style.display==="none"?"block":"none",pe("btn4","settings-menu"),Ft.style.display==="block"?document.addEventListener("click",fe):document.removeEventListener("click",fe)}function fe(l){const e=document.querySelector("#btn1"),i=document.querySelector("#btn4");!Ft.contains(l.target)&&!i.contains(l.target)&&(Ft.style.display="none",pe("btn4","settings-menu")),!Ht.contains(l.target)&&!e.contains(l.target)&&(Ht.style.display="none",pe("btn1","tickers-menu")),Ft.style.display==="none"&&Ht.style.display==="none"&&document.removeEventListener("click",fe)}function pe(l,e){const i=document.getElementById(e),s=document.getElementById(l);(l==="btn1"||l==="btn4")&&(i.style.display==="block"?s.classList.add("active"):s.classList.remove("active"))}function He(l){return l>=1e9?(l/1e9).toFixed(2)+"b":l>=1e6?(l/1e6).toFixed(2)+"m":l>=1e3?(l/1e3).toFixed(2)+"k":l}function ze(l,e,i){let s;return e==="mark_price"?l>10?s=Math.round(l*100)/100:s=Math.round(l*1e4)/1e4:e==="volume"?(s=He(l),s="$"+s):e==="open_interest"&&(s=He(l*i),s="$"+s),s}function $e(l){let e=document.querySelector("#tickers-menu table tbody");e.innerHTML="";let i=Object.entries(l);i.sort(([,s],[,n])=>n.volume-s.volume);for(let s=0;s<i.length;s++){let[n,a]=i[s],h;s<e.rows.length?h=e.rows[s]:(h=e.insertRow(),h.insertCell(),h.insertCell(),h.insertCell(),h.insertCell(),h.insertCell(),h.insertCell(),h.insertCell()),h.classList.add("table-row"),h.cells[0].textContent=n,h.cells[1].textContent=ze(a.mark_price,"mark_price",a.mark_price),h.cells[2].textContent=(Math.round(a.change*100)/100).toFixed(2)+"%",h.cells[3].textContent=a.funding_rate+"%",h.cells[4].textContent=ze(a.open_interest,"open_interest",a.mark_price),h.cells[5].textContent=a.OI_24hrChange+"%",h.cells[6].textContent=ze(a.volume,"volume",a.mark_price);const c=Math.min(Math.abs(a.change/100),1),d=Math.max(Math.abs(a.funding_rate*50),.2);a.change<0?h.style.backgroundColor="rgba(192, 80, 78, "+c*1.5+")":h.style.backgroundColor="rgba(81, 205, 160, "+c+")",a.funding_rate>0?h.cells[3].style.color="rgba(212, 80, 78, "+d*1.5+")":h.cells[3].style.color="rgba(81, 246, 160, "+d*1.5+")",h.addEventListener("click",function(){cs(n,a.mark_price)})}}function Fe(l){const e=l.clientWidth,i=l.clientHeight;(l.width!==e||l.height!==i)&&(l.width=e,l.height=i)}let ms=[{id:"canvas1",overlayId:"overlay-canvas1"},{id:"canvas2",overlayId:"overlay-canvas2"},{id:"canvas3",overlayId:null},{id:"canvas4",overlayId:null}],fs=ms.map(l=>{let e=document.querySelector(`#${l.id}`);Fe(e);let i=e.getContext("2d"),s=null,n=null;return l.overlayId&&(s=document.querySelector(`#${l.overlayId}`),Fe(s),n=s.getContext("2d")),{ctx:i,canvas:e,width:e.width,height:e.height,overlayCtx:n,overlayCanvas:s}});const ps=new as,Oe=new Ke(fs);function gs(l,e){ys(l).then(([i,s])=>{ps.createWebSocket(l,n=>Oe.updateData(n)),Oe.startNew(l,i,s,e),document.querySelector("#ticksize-select").dispatchEvent(new Event("change")),document.querySelector("#tickerInfo-name").textContent=l})}async function ys(l){let s=(await(await fetch("https://fapi.binance.com/fapi/v1/exchangeInfo")).json()).symbols.find(n=>n.symbol===l);return s?[s.filters[0].tickSize,s.filters[2].minQty]:null}
